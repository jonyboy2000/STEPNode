<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
   <TITLE>STEP-NC DLL Introduction</TITLE>
   <link rel="stylesheet" type="text/css" href="../pkgcss/style.css">
</HEAD>

<BODY>
<TABLE class=pagehead><TR>
<TD class=logo>STEP-NC DLL Introduction</TD>
<TD class=quicklinks>
  <A HREF="http://www.steptools.com">[www.steptools.com]</a>
  <A HREF="../index.html">[STEP-NC Machine]</A>
  <A HREF=index.html>[STEP-NC DLL]</a>
</TD></TR>
</TABLE>

<div class=bktoc>
<FORM class=bksearch method=GET action="http://www.google.com/search">
Search STEP Tools Web Support<br>
<INPUT TYPE=text name=q size=22 maxlength=255 value="">
<INPUT TYPE=hidden name=q value="site:www.steptools.com/support">
<INPUT class=button type=submit name=sa VALUE="Google">
</FORM>
<ul>
<li><a href="#oview">Overview</a>
<li><a href="#introsamples">Introductory Examples</a>
</ul>
</div>

<div class=main>

<!-- ================================ -->
<h2><a name=oview></a>Overview</h2>

<p>The STEP-NC DLL is a library of functions for intelligent
machining.  The value of the STEP-NC DLL is that it integrates
Geometric Dimension and Tolerance (GD&amp;T) information as defined by
CAD systems, with cutting tool path and machining process information
as defined CAM systems. It does this using a new standard formally
known as ISO 10303-238 but also called AP-238 or STEP-NC. Because the
data is integrated, machining applications can compare the quality of
a machining process against its design requirements and use this
information to make parts more intelligently, quickly and
accurately. Because the data is defined by an ISO standard the parts
described by the data can be machined and measured on a wide variety
of machiness under a wide variety of conditions.

<p>The functions in the STEP-NC DLL can be called from many different
programming languages. Some typical example applications include:

<ul>
<li>Data Assembly &#150;The application creates a STEP-NC program from
CAD geometries files, and CAM tool paths.

<li>Conventional Machining &#150; The application converts the machine
neutral STEP-NC program into M and G codes for a specific CNC control.

<li>Conventional Measurement &#150; The application converts the
machine netural measurement operations into DMIS operations for
execution on a CMM.

<li>Intelligent Machining and Measurement &#150; The application
optimizes the machining process (feeds and speeds), and adjusts
toolpaths using feedback from sensors and measurement devices.  
</ul>

<p>The STEP-NC DLL is divided into objects that provide groupings of
similar functionality. Each object consists of a series of related
functions and is described in the following sections.  
<!-- ================================ -->
<h2 class=rule><a name=introsamples></a>Introductory Examples</h2>

<p>The syntax of a STEP-NC DLL application depends on the programming
language. In all the languages a prelude is necessary to connect
programming objects to one or more of the DLL objects. The examples
below assume all the objects in the STEP-NC DLL have been connected to
one programming object called &#147;Step". This is uncommon
because most programming languages require each DLL object to be
connected to a different programming object.

<p>First we give two simple examples of how to make toolpaths. The
script below creates and saves a STEP-NC AP-238 file with one RAPID
tool movement and a single cutting tool.

<p> 
<PRE class=code>
Step-&gt;<a href="AptStepMaker.html#Partno">PartNo</a> ("test part");
Step-&gt;<a href="AptStepMaker.html#DefineTool">DefineTool</a> (0.25, 5.0, 1.0, 2.0, 3.0, 4.0, 5.0);
Step-&gt;<a href="AptStepMaker.html#LoadTool">LoadTool</a> (1);
Step-&gt;<a href="AptStepMaker.html#Rapid">Rapid</a> ();
Step-&gt;<a href="AptStepMaker.html#GoToXYZ">GoToXYZ</a> (&quot;point001&quot;, 1.0, 12.0, 0.0);          
Step-&gt;<a href="AptStepMaker.html#GoToXYZ">GoToXYZ</a> (&quot;point002&quot;, 1.0, 14.0, 0.0);
Step-&gt;<a href="AptStepMaker.html#SaveAsModules">SaveAsModules</a> ("test");
</PRE> 

<p>The next script sets the feed and spindle speed before machining a line and an arc.

<PRE class=code>
Step-&gt;<a href="AptStepMaker.html#Partno">PartNo</a> ("test part");
Step-&gt;<a href="AptStepMaker.html#DefineTool">DefineTool</a> (0.25, 5.0, 1.0, 2.0, 3.0, 4.0, 5.0);
Step-&gt;<a href="AptStepMaker.html#LoadTool">LoadTool</a> (1);
Step-&gt;<a href="AptStepMaker.html#SpindleSpeed">SpindleSpeed</a> (2000);   
Step-&gt;<a href="AptStepMaker.html#Feedrate">Feedrate</a> (100);        
Step-&gt;<a href="AptStepMaker.html#CoolantOn">CoolantOn</a>();           
Step-&gt;<a href="AptStepMaker.html#GoToXYZ">GoToXYZ</a> (&quot;point001&quot;, 1.0, 12.0, 0.0);
Step-&gt;<a href="AptStepMaker.html#GoToXYZ">GoToXYZ</a> (&quot;point002&quot;, 1.0, 14.0, 0.0);
Step-&gt;<a href="AptStepMaker.html#Arc">Arc</a> (&quot;arc001&quot;, 3., 12., 0., 1., 12., 0., 2., false);
Step-&gt;<a href="AptStepMaker.html#SaveAsPart21">SaveAsPart21</a> ("test2");
</PRE>
 
<p>The third script reads a STEP-NC program and partially decodes its
main workplan. A STEP-NC program is divided into workingsteps that
contain toolpaths. The working steps are grouped into workplans. A
workplan known as the "Main Workplan" defines the root of the
program. In addition to workingsteps, a workplan may contain other
workplans, NC functions, Selectives and probing
workingsteps. Workingsteps perform machining operations. NC functions
perform operations that do not require tool movements. A selective is
similar to a workplan except only one of the executables is to be
executed at run time. A probing workingstep is a special type of
workingstep that contains probing operations.
<p> 

<PRE class=code>
Step-&gt;<a href="Finder.html#Open238">Open238</a>("test4");

int wp_id = Step-&gt;<a href="Finder.html#GetMainWorkplan">GetMainWorkplan</a> ();
int count = Step-&gt;<a href="Finder.html#GetNestedExecutableCount">GetNestedExecutableCount</a> (wp_id);

for (i = 0; i &lt; count; i++) {
     int exe_id = Step-&gt;<a href="Finder.html#GetNestedExecutableNext">GetNestedExecutableNext</a> (wp_id, i);

     if (Step-&gt;<a href="Finder.html#IsWorkingstep">IsWorkingstep</a> (exe_id))
          printf ("Item at %d is a Workingstep\n", i);
          continue;
     }

     if (Step-&gt;<a href="Finder.html#IsWorkplan">IsWorkplan</a> (exe_id))
          printf ("Item %d is a nested workplan\n", i);
          continue;
     }

     if (Step-&gt;<a href="Finder.html#IsNcFunction">IsNcFunction</a> (exe_id))
          printf ("Item %d is an NC function\n", i);
          continue;
     }

     if (Step-&gt;<a href="Finder.html#IsSelective">IsSelective</a> (exe_id))
          printf ("Item %d is a Selective\n", i);
          continue;
     }

     if (Step-&gt;<a href="Finder.html#IsProbingWorkingstep">IsProbingWorkingstep</a> (exe_id))
          printf ("Item %d is a probing workinstep\n", i);
          continue;
     }
}
</PRE>

 
<p>Further examples of how to decode the data, including examples of how to decode tool path data, are given in the <a href="Finder.html#Navigating_an_AP-238_data set using">Finder</a> object documentation. 


<p>The fourth script reads three CAD geometry files and places them in the coordinate system of the CAM data. The program is assumed to know the required coordinates and uses the three placement functions to set those coordinates.  The workpiece geometry describes the final part being made by the STEP-NC program. The rawpiece geometry defines the stock, and the fixture geometry describes the fixtures. Putting the geometries into a STEP-NC file allows an on-machine simulator to check the validity of a STEP-NC program, optimize the speeds and feeds, and compute tool path displacements for tools that are smaller or large than the ones assumed by the path.

<PRE class=code>
Step-&gt;<a href="AptStepMaker.html#Partno">PartNo</a> (&quot;fish_head&quot;);
Step-&gt;<a href="AptStepMaker.html#ReadCatiaAPTclfile">ReadCatiaAPTclfile</a> (&quot;fishhead.clfile&quot;);
Step-&gt;<a href="AptStepMaker.html#Workpiece">Workpiece</a> (&quot;Fish_Final.stp&quot;);
Step-&gt;<a href="AptStepMaker.html#WorkpiecePlacement">WorkpiecePlacement</a> (0, 0, 0, 0, 0, 1, 0, -1, 0);    
Step-&gt;<a href="AptStepMaker.html#Rawpiece">Rawpiece</a> (&quot;Fish_Stock.stp&quot;);
Step-&gt;<a href="AptStepMaker.html#RawpiecePlacement">RawpiecePlacement</a> (0, 0, 0, 0, 0, 1, 0, -1, 0);     
Step-&gt;<a href="AptStepMaker.html#Fixture">Fixture</a> (&quot;Fish_Fixture.stp&quot;);
Step-&gt;<a href="AptStepMaker.html#FixturePlacement">FixturePlacement</a> (10, 20, 0, 0, 0, 1, 0, -1, 0);
Step-&gt;<a href="AptStepMaker.html#SaveAsModules">SaveAsModules</a> ("Fish_machining.238");
</PRE>
 
<p>The placements given in the above script rotate the parts around
the Z axis to make the X axis programmed in the geometry align with
the negative Y axis of the toolpaths. In addition for the fixture the
geometry origin is moved to (10, 20, 0) after the rotation has been
completed.

<p>The geometry used for the workpiece, rawpiece and fixture can come
from any STEP file. It may be defined as a single part or as an
assembly. The former is more common for the workpiece and rawpiece and
the latter is more common for the fixture. The most common source for 
the data is a STEP AP-203 or AP-214 (CAD geometry) file. However, 
the DLL does not care provided the STEP file has geometry is harmonized
with AP-203. In paraticular the STEP-NC DLL may be used with the new
AP-242 STEP files that include geometric dimensions and tolerances.


<p>The definition of Geometric Tolerances and Dimensions is critical
for intelligent machining because with this information the control
can determine the quality of the machining process and make
adjustments as necessary. Consequently the STEP-NC DLL has functions
that allow for the direct definition of tolerances when the required
information is not otherwise available in a STEP file. Our last script
illustrates this property of the DLL.

<p>The script reads the same part geometry as the previous script. It
then establishes the A, B and C datum&#146;s for the data by picking
faces in the geometry. Two of the faces are found using functions and
one of them is found using a face name which is presumed to have been
set by a CAD system. A third way is to ask the user to pick the face
in the STEP-NC Explorer but this method is more complex.

<p>After the datums&#146; have been defined a probing operation is
applied to the hole and two tolerance constraints are defined for the
hole. The first constraint requires the perpendicularity of the hole
to not deviate within a tolerance of 0.25 millimeters The second
constraint requires the diameter of the hole to be 37.44 millimeters
with an upper limit of 0.05 (37.94) millimeters and a lowerlimit of
0.1 (37.34) millimeters.
<p> 

<PRE class=code>
     Step-&gt;PartNo (&quot;fish_head&quot;);
     Step-&gt;Workpiece (&quot;Fish_Final.stp&quot;);

     int wp_id = Step-&gt;GetMainWorkplan();

     int top_id = Step-&gt;GetFaceTop ();
     Step-&gt;PutDatumA (top_id);

     int hole_id = Step-&gt;GetFaceUsingName ("Hole1");
     Step-&gt;PutMaxDatumB (hole_id);

     int back_id = Step-&gt;GetFaceBack ();
     Step-&gt;PutDatumC (back_id);

     fea_id = tol-&gt;PlanCylinderProbing (wp_id, 0, &quot;&quot;, hole_id, 2, 5);
     tol-&gt;AddTolerancePerpendicularity (fea_id, 0.25, 1);
     tol-&gt;AddToleranceDiameterSizeValueUpperLower (fea_id, 37.44, 0.05, 0.1);
</PRE>


</div>

<div class="copyright">
  Copyright &copy; 2016 STEP Tools Inc. All Rights Reserved.<br>
</div>
</BODY>
</HTML>
