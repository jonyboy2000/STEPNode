<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
   <TITLE>Setup for a Geometry View Project</TITLE>
   <link rel="stylesheet" type="text/css" href="../pkgcss/style.css">
</HEAD>

<BODY>
<TABLE class=pagehead><TR>
<TD class=logo>Setup for a Geometry View Project</TD>
<TD class=quicklinks>
  <A HREF="http://www.steptools.com">[www.steptools.com]</a>
  <A HREF="../index.html">[STEP-NC Machine]</A>
  <A HREF="index.html">[STEP-NC DLL]</A>
</TD></TR>
</TABLE>
<div class=bktoc>
<FORM class=bksearch method=GET action="http://www.google.com/search">
Search STEP Tools Web Support<br>
<INPUT TYPE=text name=q size=22 maxlength=255 value="">
<INPUT TYPE=hidden name=q value="site:www.steptools.com/support">
<INPUT class=button type=submit name=sa VALUE="Google">
</FORM>
<ul>
<li><a href="#oview">Overview</a>
<li><a href="#toolbox">Add GeomView to the Toolbox</a>
<li><a href="#toolbox">Use GeomView in Your Program</a>

<P>
<li class=project><A HREF="../demos/stepnc_view_cs.zip">C# Viewer Project</A>

</ul>
</div>
<div class=main>
<h2><a name=oview></a>Overview</h2>

<P>The STEP-NC DLL contains a Windows Forms control for geometry
viewing.  To use it, first create your .NET Windows Forms project
and <a href="howto_setup.html">add a reference to the STEP-NC DLL</a>.

<!-- ================================ -->
<h2 class=rule>
<a name=toolbox></a>Add GeomView to the Toolbox</h2>

<P>The DLL contains a Windows Forms control for geometry viewing, but
you must manually add it to the toolbox as described below before you
can use it in the Visual Studio GUI Designer. 

<div class=figleft><a href="images/geomview_browse.png"><img src="images/geomview_browse_sm.png"></a></div>

<p>Open the Visual Studio Toolbox pane.  Right click and
select <b>Choose Items ...</b>.  This will open the dialog shown
below.

<P>Select the <b>.NET Framework Components</b> tab, then
click <b>Browse</b>.

<P>Navigate to the STEP-NC Machine installation under "Program Files
(x86)\STEP Tools\STEP-NC Machine" and pick the <b>stepnc_x86.dll</b>
file.

<P>You can click on the <b>Namespace</b> column and find all of the
"STEPNCLib" classes.  Make sure that <b>GeomView</b> is checked.

<P>The <b>GeomView</b> control will now appear in the Toolbox under
the General tab and can be added to
your <a href="howto_setup.html#dualref">32bit or 64bit STEP-NC
Programs</a>.  The control remains in the toolbox and can be used






<!-- ================================ -->
<h2 class=rule>
<a name=toolbox></a>Use GeomView in Your Program</h2>

<div class=figleft><img src="images/geomview_place.png"></div>

<P>Add a <b>GeomView</b> control to your Windows Forms application by
dragging it from the toolbox into your dialog.

<P>The control gives fine-grained viewing control for STEP-NC files.
The code below shows an example of a button click event that will load
a file into the control.

<P>The <b>LoadSTEPFile()</b> call tells the control to read a STEP-NC
file or reinitialize itself from a file already in memory.

<P>The <b>DisplayMode</b> property is set to VIEW is for displaying
individual workpieces and you can use the <b>DisplayInstance()</b>
function to toggle workpieces on and off.

<P>To display a plain STEP file you must first create a new project
and then import the file as a workpiece using the APT class, then tell
the viewer to load the same project name, then use DisplayInstance to
turn on the individual product.

<PRE class="code figclear">
STEPNCLib.AptStepMaker apt = new STEPNCLib.AptStepMaker();

private void button1_Click(object sender, EventArgs e)
{
    OpenFileDialog dlg = new OpenFileDialog();
    dlg.Title = "Open STEP File";
    dlg.Filter = "STEP-NC Files (*.stp;*.step;*.p21)|*.stp;*.step;*.p21|" + 
	    "All Files (*.*)|*.*";

    if (dlg.ShowDialog() == System.Windows.Forms.DialogResult.OK) 
    {
	apt.NewProject("stepnc_wrapper");
	apt.Workpiece(dlg.FileName);
	System.Int64 wp = apt.GetCurrentWorkpiece();

	geomView1.LoadSTEPFile("stepnc_wrapper");
	geomView1.DisplayMode = STEPNCLib.GeomView.DisplayModeValue.VIEW;
	geomView1.DisplayInstance(wp, true);
	geomView1.ZoomAll();
    }
}

</PRE>

<div class=figright><img src="images/geomview_sample.png"></div>

<P>You can get started with 
<A HREF="../demos/stepnc_view_cs.zip">a sample C# viewer project</A>
that contains the code above.


<p>This example can read and display a plain STEP CAD file.  The
viewer comes up in rotate mode by default, but you can change
the <b>MouseMode</b> property to pan or select items.

<P>You can zoom in or out by assigning a value to the <b>Zoom</b>
property.  A value of 1 is guaranteed to show the complete bounding
box of all shapes.  The <b>ZoomAll()</b> function will size the
image to fit the currently displayed items.


</div>
<div class="copyright">
  Copyright &copy; 2016 STEP Tools Inc. All Rights Reserved.<br> 
</div>
</BODY>
</HTML>
